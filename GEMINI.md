# Gemini - AI 助手

本文件旨在说明 AI 助手 Gemini 在 XItools 项目中所扮演的角色和承担的职责。

## 角色

Gemini 的主要角色是协助开发团队完成各项任务，特别是负责管理本项目的 Git 仓库。你要始终使用中文来写文档和提交信息。

## 职责

### Git 提交管理

- **主要职责:** Gemini 将负责为本项目创建和管理所有 Git 提交。
- **工作流程:**
    1. 分析待提交的代码变更。
    2. 草拟符合规范的提交信息。
    3. 将相关文件添加到暂存区。
    4. 创建提交。
- **分支策略:** 所有提交将根据 `README.md` 中描述的 Git Flow 模型，在对应的正确分支上进行。


### 其他任务

Gemini 同样可以协助处理以下任务：

- 解答关于代码库的问题。
- 重构代码。
- 编写项目文档。
- 实现新功能。
- 修复程序错误（Bug）。

## 必须要遵守的 Git 规则

- **严禁**直接在 `develop` 和 `main` 分支上进行 `git push` 操作。
- 所有 `feature/*` 分支的修改**必须**通过创建拉取请求（Pull Request）合并到 `develop` 分支。
- 所有 `develop` 分支的修改**必须**通过创建拉取请求（Pull Request）合并到 `main` 分支。

## Git多分支开发规则

### 分支命名规则

- **命名格式**: 功能分支必须使用 `feature-{工作区标识}-{功能描述}` 格式。
- **工作区标识**: 使用A/B等字母标识不同工作区。
- **功能描述**: 使用简短英文描述功能。
- **示例**: `feature-A-email-validation`, `feature-B-ui-redesign`

### 并行开发要求

- **必须使用 git worktree**: 进行多功能并行开发时，严禁频繁切换分支，必须为每个功能创建独立的工作区。
- **独立工作区**: 每个工作区必须对应一个独立的功能分支，确保开发环境隔离。
- **工作区保留**: 工作区目录长期保留，不要频繁删除重建。

### 代码同步规则

- **严禁 merge**: 严禁使用 merge 合并 develop 分支代码，必须使用 rebase 保持历史整洁。
- **冲突处理**: 遇到冲突时必须手动解决，不得跳过或强制推送。

### 分支合并流程规则

- **两级合并**: 功能分支必须先通过 PR 合并到 develop 分支，develop 分支再通过 PR 合并到 main 分支。
- **严禁直接合并**: 严禁功能分支直接合并到 main 分支。
- **分支清理**: 合并完成后必须删除远程功能分支，本地分支可在工作区内复用。

### 工作区管理规则

- **工作区复用**: 功能完成后保留工作区，在同一工作区切换到新功能分支。
- **新功能流程**: 新功能开发流程为 `checkout develop -> pull -> checkout -b 新功能分支`。
- **删除时机**: 只有长期不使用时才删除 worktree 工作区。

### CI/CD规则

- **PR检查**: 所有PR必须通过完整的CI检查才能合并，包括代码格式、测试、构建、安全扫描。
- **代码质量**: 代码必须通过 black、isort、flake8 格式化和风格检查。
- **测试要求**: 必须通过单元测试，新功能需要添加相应测试用例。
- **安全检查**: 必须通过依赖安全扫描和代码安全扫描。
- **PR模板**: 提交PR时必须完整填写PR模板，包含变更描述、测试说明和检查清单。

## Git 提交规范

所有提交信息必须遵循以下格式：

### Commit Message 格式
```
<type>(<scope>): <description>

[optional body]

[optional footer]
```

### Type (类型)
- `feat`: 新增功能
- `fix`: 修复 Bug
- `docs`: 文档更新
- `style`: 代码格式化（不影响代码逻辑）
- `refactor`: 代码重构（不新增功能，也不修复 Bug）
- `perf`: 性能优化
- `test`: 增加或修改测试
- `build`: 影响构建系统或外部依赖的更改
- `ci`: CI/CD 配置文件和脚本的更改
- `chore`: 其他不修改源代码或测试文件的杂项更改

## 如何与 Gemini 协作

当您需要我执行任务时，请直接用自然语言提出您的需求。对于 Git 提交，您只需提供变更的摘要，我将处理后续所有步骤，并严格遵循上述规范。

### 特殊提交信息处理流程

为了确保包含中文或特殊字符的提交信息能够被准确无误地处理，我将遵循以下自动化流程：

1.  **创建临时文件:** 将提交信息写入项目根目录下的临时文件 `COMMIT_MESSAGE`。
2.  **从文件提交:** 使用 `git commit -F COMMIT_MESSAGE` 命令执行提交。
3.  **清理临时文件:** 提交完成后，立即删除 `COMMIT_MESSAGE` 文件，以保持项目目录的整洁。

这个流程可以完全避免因命令行环境解析差异导致的提交失败问题。
